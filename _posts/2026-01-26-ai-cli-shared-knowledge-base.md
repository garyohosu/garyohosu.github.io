---
title: "Claude Code・Codex CLI・Gemini CLIで共通ナレッジベースを運用する方法"
date: 2026-01-26 20:00:00 +0900
categories: [Dev, AI]
tags: [Claude Code, Codex CLI, Gemini CLI, AI, 運用, ナレッジベース, AGENTS.md]
description: "複数のAI CLIツールで過去の教訓を共有するため、AGENTS.mdを共通ナレッジベースとして運用する方法を紹介します。問題が発生したら記録し、同じ失敗を繰り返さない仕組みを構築しました。"
---

## はじめに：なぜ共通ナレッジベースが必要か

私はブログ運用に複数のAI CLIツールを使い分けています：

- **Claude Code** - Anthropicの公式CLI
- **Codex CLI** - OpenAIのCLI
- **Gemini CLI** - GoogleのCLI

それぞれのCLIには起動時に読み込む設定ファイルがあります：

| CLI | 起動時に読むファイル |
|-----|-------------------|
| Claude Code | `CLAUDE.md` |
| Codex CLI | `AGENTS.md` |
| Gemini CLI | `AGENTS.md` |

問題は、**過去に発生した問題と解決策を各CLIが共有できていなかった**ことです。

例えば、Claude Codeで「URLスラッグの衝突」問題を解決しても、次にCodex CLIを使ったときに同じミスを繰り返す可能性がありました。

---

## 解決策：AGENTS.mdを共通ナレッジベースに

### 構成

```
├── CLAUDE.md       # Claude Code用（AGENTS.mdを参照するだけ）
├── AGENTS.md       # 共通ナレッジベース（全CLI共通）
└── CHANGELOG.md    # 変更履歴
```

### CLAUDE.md（シンプル）

```markdown
# CLAUDE.md

**作業開始前に必ず `AGENTS.md` を読んでください。**

AGENTS.mdには以下が記載されています：
- プロジェクト概要
- 運用ルール
- 再発防止チェックリスト
- 過去のインシデント記録
- ファイル命名規則
```

Claude Codeは`CLAUDE.md`を読み、そこから`AGENTS.md`を参照します。

### AGENTS.md（共通ナレッジベース）

Codex CLIとGemini CLIは直接`AGENTS.md`を読むため、ここに全ての情報を集約します。

---

## AGENTS.mdの構成

### 1. プロジェクト概要

```markdown
## プロジェクト概要

- **種別**: Jekyll静的ブログサイト（Chirpyテーマ）
- **ホスティング**: GitHub Pages
- **URL**: https://garyohosu.github.io/
```

### 2. 運用ルール

```markdown
## 必読：運用ルール

### 1. 問題発生時の対応

**問題が発生し解決した場合は、必ず以下を実施すること**:

1. 本ファイル（AGENTS.md）の「インシデント記録」セクションに追記
2. 原因と解決方法を明記
3. 再発防止策を「再発防止チェックリスト」に追加

### 2. 変更管理

**何か変更を行った場合は、必ずCHANGELOG.mdに追記すること**
```

### 3. 再発防止チェックリスト

```markdown
## 再発防止チェックリスト

### 記事作成前
- [ ] `ls _posts/ | grep "<キーワード>"` で類似ファイル名を確認
- [ ] ファイル名のスラッグ部分が一意か確認
- [ ] YAMLフロントマターの引用符が正しいか確認

### プッシュ前
- [ ] `git status`で意図しない変更がないか確認
- [ ] `git diff`で変更内容を確認
```

### 4. インシデント記録

過去に発生した問題を5つのカテゴリーに分類して記録：

| カテゴリー | 問題例 |
|-----------|-------|
| URLとファイル名 | スラッグ衝突 |
| YAMLフロントマター | 引用符の入れ子エラー |
| 画像関連 | ファイル欠落、使い回し |
| 設定ファイル | 依存関係エラー、テーマ誤変更 |
| CLI/ツール | MCP設定エラー |

各インシデントには以下を記載：
- **症状**: 何が起きたか
- **原因**: なぜ起きたか
- **解決**: どう直したか
- **再発防止**: 今後どう防ぐか

---

## 運用フロー

### 通常の作業

```
1. CLIを起動
2. AGENTS.mdを読む（自動）
3. チェックリストに従って作業
4. 変更があればCHANGELOG.mdに追記
```

### 問題発生時

```
1. 問題を解決
2. AGENTS.mdの「インシデント記録」に追記
3. 「再発防止チェックリスト」に項目を追加
4. CHANGELOG.mdに記録
5. コミット・プッシュ
```

---

## メリット

### 1. ナレッジの共有

どのCLIを使っても、過去の全ての教訓にアクセスできます。

### 2. 同じ失敗を繰り返さない

チェックリストとインシデント記録により、過去の失敗を防止できます。

### 3. 変更履歴の追跡

CHANGELOG.mdにより、いつ何が変更されたか追跡可能です。

### 4. AIエージェントの学習

AIは起動時にナレッジベースを読むため、人間のように「前回のことを覚えていない」問題を軽減できます。

---

## 実際の効果

このブログでは過去に14件のインシデントが発生しました。それぞれの原因と解決策を記録したことで：

- **URLスラッグ衝突**: 記事作成前にファイル名を確認する習慣がついた
- **画像ファイル欠落**: プッシュ前にローカルビルドで確認するようになった
- **設定ファイル誤変更**: `git diff`で変更内容を確認するようになった

---

## まとめ

複数のAI CLIを使い分ける場合、**共通のナレッジベース**を用意することで：

1. 過去の教訓を全てのCLIで共有
2. 同じ失敗を繰り返さない仕組みを構築
3. 変更履歴を追跡可能に

`AGENTS.md`というファイル名は、Codex CLIとGemini CLIが起動時に読み込む仕様に合わせています。Claude Codeは`CLAUDE.md`経由で参照します。

AI CLIツールを活用している方の参考になれば幸いです。

---

## 参考

- [Claude Code公式ドキュメント](https://docs.anthropic.com/claude-code)
- [Codex CLI](https://github.com/openai/codex)
- [Gemini CLI](https://github.com/google/gemini-cli)
